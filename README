Copyright (c) 2013 Severnoe DB JSC December 2013

preseed_install это ansible скрипт для установки необходимых пакетов и их настройки на хост-машине, 
которая должна стать сервером для установки ОС на целевых машинах (узлах) по сети.

Используются следующие пакеты:
- dnsmasq (TODO попробывать встроенный в dnsmasq tftp)
- tftpd-hpa
- apache

Данная конфигурация настроена на установку по сети ОС Astra Linux Special Edition. 
Для этого доработан инсталлятор (по отношению к netinst c оригинального диска с ОС Astra Linux 1.3):
- изменен usr/share/localechooser/languagelist поддержка русскому языку изменена с 2 на 1.
  было ru;2;RU;ru_RU.UTF-8;;console-setup стало ru;1;RU;ru_RU.UTF-8;;console-setup
- добавлен модуль dca.ko в lib/modules/3.2.0-27-generic/kernel/drivers/dca/
- добавлены модули dm-log.ko dm-mirror.ko dm-mod.ko dm-region-hash.ko в lib/modules/3.2.0-27-generic/kernel/drivers/md/
- добавлены ключи spkb-archive-keyring.gpg от собственного репа (он служит зеркалом при установке) в usr/share/keyrings

****************
распаковка и упаковка initrd.gz

раз
#!/bin/sh
if [ -d $1 ]; then
sudo rm -rf $1
fi
if [ -f initrd ]; then
sudo rm initrd
fi
if ! [ -f initrd.gz ]; then
echo "initrd.gz not found"
exit 1
fi
sudo gunzip initrd.gz
sudo mkdir $1
cd $1
sudo cpio -id < ../initrd

два
#!/bin/sh
if ! [ -d $1 ]; then
echo "folder not found"
exit 1
fi
if [ -f initrd ]; then
sudo rm initrd
fi
if [ -f initrd.gz ]; then
sudo rm initrd.gz
fi
cd $1
sudo find . | cpio --create --format='newc' > ../initrd
cd ..
sudo gzip initrd
****************

В качестве зеркала используется собственный репозиторий пакетов, в котором:
- добавлен пакет  grub-installer_1.78ubuntu8_amd64.udeb, поскольку grub-installer_1.70astra.se4_amd64.udeb содержит 
  ошибки при установке grub на soft&fake raid.