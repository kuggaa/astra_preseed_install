# переменные для настройки сервера автоматической инсталляции ОС

# Доступные опции 'http' or 'ftp'
server_type: 'ftp'

# Указываем имя необходимого шаблона (preseed file) для автоматической установки linux,
# если нужен другой шаблон, то его можно
# создать по аналогии c шаблонами расположенными в roles/common/templates
default_preseed: 'preseed.softraid.cfg.j2'

# Имя цели используемое tftp
os_name: 'astra'
# Имя домена
default_domain: 'hac'

# Пароли !! После установки рекомендуется сменить пароли !!
password:
   user: 'useruser'
   root: 'password'
   grub: '12345678'

# путь к файлам tftp
link_to_tftp_files: 'tftpboot'

network:
   addr: '{{ hostvars[inventory_hostname].ansible_eth0.ipv4.address }}'
   mask: '{{ hostvars[inventory_hostname].ansible_eth0.ipv4.netmask }}'
   network: '{{ hostvars[inventory_hostname].ansible_eth0.ipv4.network }}'
   name: '{{ hostvars[inventory_hostname].ansible_eth0.device }}'

# Полную путь к репозиторию пакетов
#(!репозиторий создается самостоятельно, простейший случай просто путь к подмонтированному cd диску!) 
# !переменные используются, только если установлен server_type в http!
# в случае http репозитории ПК КВГ и devel репозиторий Astra Linux не разворачиваются!
http:
    path_to_packages_mirror: '/srv/se13'
    link_to_packages_mirror: 'astra'
    path_to_tftp_files: '/srv/tftp'
    
# Для пути к репозиторию ПК КВГ (для варианта когда используется ftp)
# !переменные используются, только если установлен server_type в ftp!
ftp:
    path_to_ftp_root: '/home/ftp'
    astra_rep_name: 'astra_rep_1.4'
    dev_astra_rep_name: 'astra_dev'
    hac_rep_name: 'hac'
    src_with_astra_rep: '/media/cdrom'
    src_with_dev_astra_rep: '/media/cdrom'
    src_with_hac_rep: '/media/cdrom'

# Настройки dnsmasq
dhcp:
    # Включение/выключение статического режима dhcp сервера: false или true,
    # если установлено в true, то адреса выдаются только по тем mac-адресам, которык указаны в machines_by_mac
    static_mode: true
    # Диапозон адресов, используется когда static_mode равен false
    subset: [172.16.0.90, 172.16.0.125, 255.255.255.0]

# Список для автоназначения hostname, для добавления новой машины, через запятую
# пишем { hostname: 'Имя машины(доступны след. символы 'a-zA-Z0-9' и знак '-')', 
#         ip: 'ip адрес из диапазона указанного в dhcp_subset' }
## target_machines: [{ hostname: 'hacnode1', ip: '172.16.0.50' },  { hostname: 'hacnode2', ip: '172.16.0.51' }]

# В случае если Вам необходимо назначить определенный hostname на определенную машину, 
# НЕ используйте вариант задания через переменную target_machines, 
# вместо этого заполняйте переменную machines_by_mac. В ней обязательно определяйте mac и
# желаемый для данного mac'а hostname, можно еще также указывать специальный preseed 
# (если не указать будет использован preseed файл по-умолчанию из переменной default_preseed). 
# Все preseed складываем в roles/common/templates.
# По-умолчанию сеть настраивается c dhcp, если Вам необходим статический IP
# добавьте опцию ip в следующем формате - ip: XXX.XXX.XXX.XXX,
# также можно, если понимаете зачем Вам это, указать mask (по-умолчанию берется netmask host-машины)
# Пример настройки для статического ip:
# { mac: '00-1c-c0-f8-ff-6a', hostname: 'example', preseed: 'preseed.cfg.j2', ip: 10.10.10.50 }
# Пример настройки для статического ip с netmask:
# { mac: '00-1c-c0-f8-ff-6a', hostname: 'example', preseed: 'preseed.cfg.j2', ip: 10.10.10.50, mask: 255.255.255.0 }

machines_by_mac:
    - { mac: ['00-25-90-cb-03-2b', '00-25-90-cb-03-2a', '90-e2-ba-21-35-60', '90-e2-ba-21-35-61'], hostname: 'hacnode1', ip: 172.16.0.20 }
    - { mac: ['00-25-90-c9-a3-fc', '00-25-90-c9-a3-fd', '90-e2-ba-29-cc-76', '90-e2-ba-29-cc-77'], hostname: 'hacnode2', ip: 172.16.0.21 }
    - { mac: ['00-25-90-c7-72-b4', '00-25-90-c7-72-b5', '90-e2-ba-23-5f-dc', '90-e2-ba-23-5f-dd'], hostname: 'hacnode3', ip: 172.16.0.22 }
    - { mac: ['00-1c-c0-f8-ff-6a'], hostname: 'crimea', preseed: 'preseed.cfg.j2', ip: 172.16.0.100 }
    - { mac: ['00-1c-c0-f8-f8-fe'], hostname: 'adm-station', preseed: 'preseed.cfg.j2', ip: 172.16.0.211 }

